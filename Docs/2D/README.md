# Aqui Programming Language Documentation

## Overview

Aqui is a domain-specific programming language designed for **parametric shape creation and graphical design**, particularly in digital fabrication contexts.

---

## 1. Language Structure

Aqui code consists of declarations and instructions. The language supports:

* Parameters (`param`)
* Shape definitions (`shape`)
* Conditional logic (`if`, `else`)
* Loops (`for`, `from`, `to`, `step`)
* Functions (`def`)
* Transformations (`transform`, `position`, `rotate`, `scale`)
* Boolean operations (`union`, `difference`, `intersection`)
* Layers (`layer`)
* Drawing commands (`draw`)

---

## 2. Tokens and Keywords

Aqui is case-insensitive. Reserved keywords include:

### Shape Keywords

`shape`, `rectangle`, `circle`, `triangle`, `ellipse`, `path`, `star`, `arc`, `text`, `bezierCurve`, `donut`, `spiral`, `wave`, `gear`, `roundedRectangle`, `chamferRectangle`, `polygon`, `arrow`, `cross`, `slot`, `polygonWithHoles`, `dovetailPin`, `dovetailTail`, `fingerJointPin`, `fingerJointSocket`, `halfLapMale`, `halfLapFemale`, `crossLapVertical`, `crossLapHorizontal`, `slotBoard`, `tabBoard`, `fingerCombMale`, `fingerCombFemale`

### Logic Keywords

`if`, `else`, `and`, `or`, `not`, `true`, `false`

### Loop Keywords

`for`, `from`, `to`, `step`

### Function Keywords

`def`

### Boolean Operation Keywords

`union`, `difference`, `intersection`

### Transformation Keywords

`transform`, `position`, `rotate`, `scale`

### Drawing Keywords

`draw`, `forward`, `backward`, `right`, `left`, `goto`, `penup`, `pendown`

### Styling Tokens

`fill`, `filled`, `fillColor`, `stroke`, `strokeColor`, `strokeWidth`, `opacity`, `alpha`, `visible`, `hidden`, `color`, `background`, `border`, `thickness`

---

## 3. Parameters

```aqui
param size 100
param isVisible true
```

Parameters are global variables used in any part of the code.

---

## 4. Shape Declaration

```aqui
shape circle myCircle {
  radius: 30
  position: [50, 50]
}
```

Each shape block has:

* A **type**
* A **name**
* A list of parameters

All shape types and their required parameters are listed in section 13.

---

## 5. Boolean Operations

### Example

```aqui
shape rectangle rect1 {
  width: 100
  height: 50
  position: [0, 0]
}

shape circle circ1 {
  radius: 30
  position: [0, 0]
}

union combined {
  add rect1
  add circ1
}

difference cutout {
  add rect1
  add circ1
}
```

---

## 6. Transformations

```aqui
transform myShape {
  rotate: 30
  position: [100, 50]
}
```

---

## 7. Conditional Logic

Aqui supports complex conditions with logical operators:

```aqui
if (size > 50 and showDetails) or isSpecial {
  // Code to execute if condition is true
}
```

---

## 8. Loops

### Shape Naming in Loops

Loop-generated shapes are automatically named with the format: `name_index`. Format:
```aqui
<shape_name>_0_0 // first shape generated by loop
<shape_name>_1_1 // first shape generated by loop
<shape_name>_2_2 // first shape generated by loop
<shape_name>_3_3 // first shape generated by loop
```

This allows you to reference them later:

```aqui
for i from 0 to 3 {
  for j from 0 to 3 {
    shape ellipse a {
      radiusX: 20
      radiusY: 50
      position: [i * 30, j * 30]
    }
  }
}

transform a_0_0 {
  rotate: 45
}
```

### Nested Loops

You can nest loops for grids and matrices:

```aqui
for i from 0 to 3 {
  for j from 0 to 3 {
    shape circle gridCircle {
      radius: 10
      position: [i * 30, j * 30]
    }
  }
}
```

### Full Example

```aqui
def createCircleGrid(startX, startY, rows, cols, spacing, baseRadius) {
  for i from 0 to rows - 1 {
    for j from 0 to cols - 1 {
      param x startX + j * spacing
      param y startY + i * spacing
      param radius baseRadius * (1 + 0.3 * (i + j) / (rows + cols))
      createCircle(param.x, param.y, param.radius)
    }
  }
}

def createCircle(x, y, radius) {
  shape circle dynamicCircle {
    radius: radius
    position: [x, y]
  }
}

createCircleGrid(-100, -100, 5, 5, 40, 10)
```

---

## 9. Functions

```aqui
def createCircle(x, y, radius) {
  shape circle dynamicCircle {
    radius: radius
    position: [x, y]
  }
}

createCircle(50, 50, 100)
```

Functions define reusable blocks but do not return values.

---

## 10. Turtle Drawing

```aqui
draw square {
  forward 50
  right 90
  forward 50
  right 90
  forward 50
  right 90
  forward 50
}
```

Commands:

* `forward`, `backward`, `right`, `left`
* `goto [x, y]`, `penup`, `pendown`

---

## 11. Layers

```aqui
layer main {
  add shape1
  add shape2
}
```

Applies to grouped shapes.

---

## 12. Paths & Custom Geometry

```aqui
shape path myPath {
  points: [[0,0], [20,0], [10,30]]
  closed: true
}
```

---

## 13. Supported Shape Types and Parameters

### **rectangle**

* `width`, `height`, `position`, `rotation`

```aqui
shape rectangle myRect {
  width: 120
  height: 80
  position: [100, 100]
  rotation: 15
}
```

### **circle**

* `radius`, `position`, `rotation`

```aqui
shape circle myCircle {
  radius: 50
  position: [200, 200]
  rotation: 0
}
```

### **triangle**

* `base`, `height`, `position`, `rotation`

```aqui
shape triangle myTriangle {
  base: 60
  height: 100
  position: [150, 150]
  rotation: 30
}
```

### **ellipse**

* `radiusX`, `radiusY`, `position`, `rotation`

```aqui
shape ellipse myEllipse {
  radiusX: 70
  radiusY: 40
  position: [300, 100]
  rotation: 45
}
```

### **polygon**

* `radius`, `sides`, `position`, `rotation`

```aqui
shape polygon myPolygon {
  radius: 60
  sides: 6
  position: [250, 250]
  rotation: 0
}
```

### **star**

* `outerRadius`, `innerRadius`, `points`, `position`, `rotation`

```aqui
shape star myStar {
  outerRadius: 80
  innerRadius: 40
  points: 5
  position: [300, 300]
  rotation: 0
}
```

### **arc**

* `radius`, `startAngle`, `endAngle`, `position`, `rotation`

```aqui
shape arc myArc {
  radius: 90
  startAngle: 0
  endAngle: 180
  position: [200, 350]
  rotation: 0
}
```

### **roundedRectangle**

* `width`, `height`, `radius`, `position`, `rotation`

```aqui
shape roundedRectangle myRoundRect {
  width: 150
  height: 100
  radius: 20
  position: [100, 300]
  rotation: 10
}
```

### **chamferRectangle**

* `width`, `height`, `chamfer`, `position`, `rotation`

```aqui
shape chamferRectangle myChamfer {
  width: 120
  height: 80
  chamfer: 15
  position: [100, 400]
  rotation: 0
}
```

### **path**

* `points`, `closed`, `position`, `rotation`

```aqui
shape path myPath {
  points: [[0,0], [100,0], [100,50], [0,50]]
  closed: true
  position: [200, 200]
  rotation: 0
}
```

### **arrow**

* `length`, `headWidth`, `headLength`, `position`, `rotation`

```aqui
shape arrow myArrow {
  length: 100
  headWidth: 20
  headLength: 30
  position: [100, 100]
  rotation: 90
}
```

### **text**

* `text`, `fontSize`, `fontFamily`, `position`, `rotation`

```aqui
shape text myText {
  text: "Hello AQUI"
  fontSize: 20
  fontFamily: "Arial"
  position: [250, 150]
  rotation: 0
}
```

### **bezierCurve**

* `startPoint`, `controlPoint1`, `controlPoint2`, `endPoint`, `position`, `rotation`

```aqui
shape bezierCurve myCurve {
  startPoint: [0, 0]
  controlPoint1: [50, 100]
  controlPoint2: [100, 100]
  endPoint: [150, 0]
  position: [100, 100]
  rotation: 0
}
```

### **donut**

* `outerRadius`, `innerRadius`, `position`, `rotation`

```aqui
shape donut myDonut {
  outerRadius: 80
  innerRadius: 40
  position: [300, 300]
  rotation: 0
}
```

### **spiral**

* `startRadius`, `endRadius`, `turns`, `position`, `rotation`

```aqui
shape spiral mySpiral {
  startRadius: 10
  endRadius: 100
  turns: 3
  position: [250, 250]
  rotation: 0
}
```

### **wave**

* `width`, `amplitude`, `frequency`, `position`, `rotation`

```aqui
shape wave myWave {
  width: 200
  amplitude: 30
  frequency: 3
  position: [150, 200]
  rotation: 0
}
```

### **cross**

* `width`, `thickness`, `position`, `rotation`

```aqui
shape cross myCross {
  width: 100
  thickness: 20
  position: [100, 100]
  rotation: 0
}
```

### **gear**

* `pitch_diameter`, `teeth`, `pressure_angle`, `position`, `rotation`

```aqui
shape gear myGear {
  pitch_diameter: 100
  teeth: 20
  pressure_angle: 20
  position: [200, 200]
  rotation: 0
}
```

### **slot**

* `length`, `width`, `position`, `rotation`

```aqui
shape slot mySlot {
  length: 100
  width: 20
  position: [200, 100]
  rotation: 0
}
```

### **polygonWithHoles**

* `outerPath`, `holes`, `position`, `rotation`

```aqui
shape polygonWithHoles myHolePoly {
  outerPath: [[0,0], [100,0], [100,100], [0,100]]
  holes: [[[25,25], [75,25], [75,75], [25,75]]]
  position: [200, 200]
  rotation: 0
}
```

### **dovetailPin**

* `width`, `jointCount`, `depth`, `angle`, `thickness`, `position`, `rotation`

```aqui
shape dovetailPin myPin {
  width: 100
  jointCount: 5
  depth: 30
  angle: 45
  thickness: 10
  position: [300, 100]
  rotation: 0
}
```

### **dovetailTail**

* `width`, `jointCount`, `depth`, `angle`, `thickness`, `position`, `rotation`

```aqui
shape dovetailTail myTail {
  width: 100
  jointCount: 5
  depth: 30
  angle: 45
  thickness: 10
  position: [300, 200]
  rotation: 0
}
```

### **fingerJointPin**

* `width`, `fingerCount`, `fingerWidth`, `depth`, `thickness`, `position`, `rotation`

```aqui
shape fingerJointPin myFJPin {
  width: 100
  fingerCount: 5
  fingerWidth: 20
  depth: 30
  thickness: 10
  position: [100, 100]
  rotation: 0
}
```

### **fingerJointSocket**

* `width`, `fingerCount`, `fingerWidth`, `depth`, `thickness`, `position`, `rotation`

```aqui
shape fingerJointSocket myFJSocket {
  width: 100
  fingerCount: 5
  fingerWidth: 20
  depth: 30
  thickness: 10
  position: [100, 200]
  rotation: 0
}
```

### **halfLapMale**

* `width`, `height`, `lapLength`, `lapDepth`, `position`, `rotation`

```aqui
shape halfLapMale maleLap {
  width: 100
  height: 50
  lapLength: 30
  lapDepth: 20
  position: [100, 100]
  rotation: 0
}
```

### **halfLapFemale**

* `width`, `height`, `lapLength`, `lapDepth`, `position`, `rotation`

```aqui
shape halfLapFemale femaleLap {
  width: 100
  height: 50
  lapLength: 30
  lapDepth: 20
  position: [100, 200]
  rotation: 0
}
```

### **crossLapVertical**

* `width`, `height`, `slotWidth`, `slotDepth`, `slotPosition`, `position`, `rotation`

```aqui
shape crossLapVertical myCrossV {
  width: 80
  height: 200
  slotWidth: 20
  slotDepth: 40
  slotPosition: 100
  position: [300, 300]
  rotation: 0
}
```

### **crossLapHorizontal**

* `width`, `height`, `slotWidth`, `slotDepth`, `slotPosition`, `position`, `rotation`

```aqui
shape crossLapHorizontal myCrossH {
  width: 200
  height: 80
  slotWidth: 20
  slotDepth: 40
  slotPosition: 100
  position: [200, 300]
  rotation: 0
}
```

### **slotBoard**

* `width`, `height`, `slotCount`, `slotWidth`, `slotDepth`, `slotPosition`, `position`, `rotation`

```aqui
shape slotBoard mySlotBoard {
  width: 300
  height: 200
  slotCount: 3
  slotWidth: 20
  slotDepth: 50
  slotPosition: 0.5
  position: [200, 200]
  rotation: 0
}
```

### **tabBoard**

* `width`, `height`, `tabCount`, `tabWidth`, `tabDepth`, `tabPosition`, `position`, `rotation`

```aqui
shape tabBoard myTabBoard {
  width: 300
  height: 200
  tabCount: 3
  tabWidth: 30
  tabDepth: 40
  tabPosition: 0.5
  position: [200, 300]
  rotation: 0
}
```

### **fingerCombMale**

* `width`, `depth`, `fingerCount`, `position`, `rotation`

```aqui
shape fingerCombMale combM {
  width: 100
  depth: 40
  fingerCount: 5
  position: [100, 100]
  rotation: 0
}
```

### **fingerCombFemale**

* `width`, `depth`, `fingerCount`, `position`, `rotation`

```aqui
shape fingerCombFemale combF {
  width: 100
  depth: 40
  fingerCount: 5
  position: [100, 200]
  rotation: 0
}
```

## 14. Style and Appearance

Each shape may also include styling options:

* `fill`, `fillColor`, `stroke`, `strokeColor`, `strokeWidth`, `opacity`, `visible`, `hidden`, `color`, `background`, `border`, `thickness`

---

## 15. Comments

```aqui
// This is a comment
```

---

## 16. Error Handling

* Errors are shown in console and error display
* Lexer/parser includes line number

---

## Tips and Best Practices

### 1. Organizing with Layers

```aqui
layer background {
  add bg_rect
}

layer foreground {
  add circle1
  add circle2
  rotate 15
}
```

### 2. Parameterizing Designs

```aqui
param gridSize 5
param spacing 30
param baseRadius 10

for i from 0 to param.gridSize {
  for j from 0 to param.gridSize {
    shape circle grid_circle {
      radius: param.baseRadius * (1 + (i + j) / (param.gridSize * 2))
      position: [i * param.spacing, j * param.spacing]
    }
  }
}
```

### 3. Function Reuse

```aqui
def createFlower(x, y, petalCount, petalLength) {
  for i from 0 to petalCount - 1 {
    param angle 360 / petalCount * i
    shape ellipse petal {
      radiusX: petalLength
      radiusY: petalLength / 4
      position: [x, y]
      rotate: angle
    }
  }

  shape circle center {
    radius: petalLength / 5
    position: [x, y]
  }
}

createFlower(0, 0, 5, 50)
createFlower(100, 100, 8, 30)
```

### 4. Using Boolean Operations

```aqui
shape roundedRectangle baseShape {
  width: 100
  height: 60
  radius: 10
  position: [0, 0]
}

shape circle cutout {
  radius: 20
  position: [0, 0]
}

difference resultShape {
  add baseShape
  add cutout
}
```
